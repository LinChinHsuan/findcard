"use strict";(self["webpackChunkfindcard"]=self["webpackChunkfindcard"]||[]).push([[13],{8013:function(t,e,s){s.r(e),s.d(e,{default:function(){return $t}});var l=s(3396),a=s(7139),d=s(9242);const o=t=>((0,l.dD)("data-v-5e696ca6"),t=t(),(0,l.Cn)(),t),i={class:"row mt-4"},r={class:"col-xl-6"},n={class:"table-responsive"},c={class:"table align-middle"},u=o((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"圖片"),(0,l._)("th",{class:"ms-2"},"商品名稱"),(0,l._)("th",{class:"text-center"},"價格"),(0,l._)("th",{class:"text-center"},"功能")])],-1))),p={style:{width:"160px"}},m=["src","alt"],h={class:"fs-5 text-end"},_={class:"text-center"},b=["disabled","onClick"],g={key:0,class:"spinner-border text-white spinner-border-sm",role:"status"},f=o((()=>(0,l._)("span",{class:"visually-hidden"},"Loading...",-1))),v=[f],w=(0,l.Uk)(" 加到購物車 "),y={class:"col-xl-6"},x={class:"table-responsive"},k={class:"table align-middle"},C=o((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{style:{width:"70px"}}),(0,l._)("th",null,"品名"),(0,l._)("th",{style:{width:"150px"}},"數量 / 單位"),(0,l._)("th",{class:"text-end"},"單價")])],-1))),D=["onClick"],$=o((()=>(0,l._)("span",{class:"material-icons"},"delete",-1))),V=[$],z={key:0,class:"text-success"},I={class:"d-flex align-items-center"},U=["disabled","onUpdate:modelValue","onBlur"],q={class:"text-end"},O={key:0},L={key:1,class:"text-success"},M={key:1},P=o((()=>(0,l._)("td",{class:"text-center py-3",colspan:"4"},"購物車空空如也",-1))),W=[P],S={key:0},E=o((()=>(0,l._)("td",{colspan:"3",class:"text-end"},"總計",-1))),H={class:"text-end"},Y={key:1},A=o((()=>(0,l._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1))),K={class:"text-end text-success"},j={class:"d-flex flex-column flex-md-row"},B={class:"input-group mt-2 mb-3 mt-md-0 mb-md-0"},F={class:"input-group ms-auto"},Z={class:"my-5 row justify-content-center"},G={class:"mb-3"},J=o((()=>(0,l._)("label",{for:"email",class:"form-label"},"Email",-1))),N={class:"mb-3"},Q=o((()=>(0,l._)("label",{for:"name",class:"form-label"},"收件人姓名",-1))),R={class:"mb-3"},T=o((()=>(0,l._)("label",{for:"tel",class:"form-label"},"收件人電話",-1))),X={class:"mb-3"},tt=o((()=>(0,l._)("label",{for:"address",class:"form-label"},"收件人地址",-1))),et={class:"mb-3"},st=o((()=>(0,l._)("label",{for:"message",class:"form-label"},"留言",-1))),lt={class:"text-end"},at={key:1,class:"col-lg-6"},dt={class:"table align-middle"},ot=o((()=>(0,l._)("thead",null,[(0,l._)("th",null,"品名"),(0,l._)("th",null,"數量"),(0,l._)("th",null,"單價")],-1))),it={class:"text-end"},rt=o((()=>(0,l._)("td",{colspan:"2",class:"text-end"},"總計",-1))),nt={class:"text-end"},ct={class:"table"},ut=o((()=>(0,l._)("th",{width:"100"},"Email",-1))),pt=o((()=>(0,l._)("th",null,"姓名",-1))),mt=o((()=>(0,l._)("th",null,"收件人電話",-1))),ht=o((()=>(0,l._)("th",null,"收件人地址",-1))),_t=o((()=>(0,l._)("th",null,"付款狀態",-1))),bt={key:0,class:"text-success"},gt={key:1,class:"text-muted"},ft={class:"d-flex mt-4"},vt={key:2,class:"col-md-10 col-xl-8"},wt={class:"bg-white d-flex flex-column text-center p-5"},yt=(0,l.uE)('<span class="material-icons display-2 text-primary mb-3" data-v-5e696ca6>check_circle</span><p class="fs-2 fw-bold mb-5" data-v-5e696ca6>付款成功</p><p class="mb-0" data-v-5e696ca6>感謝您的訂購</p><p class="mb-0" data-v-5e696ca6>商品預計於三個工作天內寄送（不含週休及國定例假日）</p><p class="mb-3" data-v-5e696ca6>再請留意簡訊通知及配送人員的電話 </p>',5);function xt(t,e,s,o,f,$){const P=(0,l.up)("Loading"),xt=(0,l.up)("VField"),kt=(0,l.up)("ErrorMessage"),Ct=(0,l.up)("VForm");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(P,{active:f.isLoading},null,8,["active"]),(0,l._)("div",i,[(0,l._)("div",r,[(0,l._)("div",n,[(0,l._)("table",c,[u,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",p,[(0,l._)("img",{src:t.imageUrl,alt:t.title,width:"160",height:"100",class:"img-fit"},null,8,m)]),(0,l._)("td",null,(0,a.zw)(t.title),1),(0,l._)("td",h,(0,a.zw)(t.price)+"元 ",1),(0,l._)("td",_,[(0,l._)("button",{type:"button",class:"btn btn-primary fw-bold text-white",disabled:f.status.loadingItem===t.id,onClick:(0,d.iM)((e=>$.addCart(t.id)),["prevent"])},[f.status.loadingItem===t.id?((0,l.wg)(),(0,l.iD)("div",g,v)):(0,l.kq)("",!0),w],8,b)])])))),128))])])])]),(0,l._)("div",y,[(0,l._)("div",x,[(0,l._)("table",k,[C,(0,l._)("tbody",null,[f.cart.carts?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(f.cart.carts,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",null,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm p-2 d-flex align-items-center",onClick:e=>$.delCartProduct(t.id)},V,8,D)]),(0,l._)("td",null,[(0,l.Uk)((0,a.zw)(t.product.title)+" ",1),t.coupon?((0,l.wg)(),(0,l.iD)("div",z," 已套用優惠券 ")):(0,l.kq)("",!0)]),(0,l._)("td",I,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",min:"1",disabled:f.status.loadingItem===t.id,"onUpdate:modelValue":e=>t.qty=e,onBlur:(0,d.iM)((e=>$.updateCartProduct(t)),["prevent"])},null,40,U),[[d.nr,t.qty,void 0,{number:!0}]]),(0,l.Uk)(" / "+(0,a.zw)(t.product.unit),1)]),(0,l._)("td",q,[t.coupon?((0,l.wg)(),(0,l.iD)("small",L,"折扣價：")):((0,l.wg)(),(0,l.iD)("small",O,"單價：")),(0,l.Uk)(" "+(0,a.zw)(parseInt(t.final_total)),1)])])))),128)):((0,l.wg)(),(0,l.iD)("tr",M,W))]),(0,l._)("tfoot",null,[f.cart.total===f.cart.final_total?((0,l.wg)(),(0,l.iD)("tr",S,[E,(0,l._)("td",H,(0,a.zw)(f.cart.total),1)])):((0,l.wg)(),(0,l.iD)("tr",Y,[A,(0,l._)("td",K,(0,a.zw)(parseInt(f.cart.final_total)),1)]))])])]),(0,l._)("div",j,[(0,l._)("div",B,[(0,l._)("button",{class:"btn btn-outline-danger fw-bold",type:"button",onClick:e[0]||(e[0]=(...t)=>$.delAllCartProducts&&$.delAllCartProducts(...t))}," 清空購物車 ")]),(0,l._)("div",F,[(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[1]||(e[1]=t=>f.coupon=t)},null,512),[[d.nr,f.coupon]]),(0,l._)("button",{class:"btn btn-primary fw-bold text-white",type:"button",onClick:e[2]||(e[2]=(0,d.iM)(((...t)=>$.useCoupon&&$.useCoupon(...t)),["prevent"]))},"套用優惠碼")])])]),(0,l._)("div",Z,[1===f.step?((0,l.wg)(),(0,l.j4)(Ct,{key:0,class:"col-lg-6",onSubmit:$.createOrder},{default:(0,l.w5)((({errors:t})=>[(0,l._)("div",G,[J,(0,l.Wm)(xt,{id:"email",name:"email",type:"email",class:(0,a.C_)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:f.form.user.email,"onUpdate:modelValue":e[3]||(e[3]=t=>f.form.user.email=t)},null,8,["class","modelValue"]),(0,l.Wm)(kt,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",N,[Q,(0,l.Wm)(xt,{id:"name",name:"姓名",type:"text",class:(0,a.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:f.form.user.name,"onUpdate:modelValue":e[4]||(e[4]=t=>f.form.user.name=t)},null,8,["class","modelValue"]),(0,l.Wm)(kt,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",R,[T,(0,l.Wm)(xt,{id:"tel",name:"電話",type:"tel",class:(0,a.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:f.form.user.tel,"onUpdate:modelValue":e[5]||(e[5]=t=>f.form.user.tel=t)},null,8,["class","modelValue"]),(0,l.Wm)(kt,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",X,[tt,(0,l.Wm)(xt,{id:"address",name:"地址",type:"text",class:(0,a.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:f.form.user.address,"onUpdate:modelValue":e[6]||(e[6]=t=>f.form.user.address=t)},null,8,["class","modelValue"]),(0,l.Wm)(kt,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",et,[st,(0,l.wy)((0,l._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[7]||(e[7]=t=>f.form.message=t)},null,512),[[d.nr,f.form.message]])]),(0,l._)("div",lt,[(0,l._)("button",{type:"submit",class:"btn btn-primary btn-lg fw-bold text-white",onSubmit:e[8]||(e[8]=(...t)=>$.createOrder&&$.createOrder(...t))},"送出訂單",32)])])),_:1},8,["onSubmit"])):2===f.step?((0,l.wg)(),(0,l.iD)("form",at,[(0,l._)("table",dt,[ot,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.order.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,a.zw)(t.product.title),1),(0,l._)("td",null,(0,a.zw)(t.qty)+" / "+(0,a.zw)(t.product.unit),1),(0,l._)("td",it,(0,a.zw)(t.total),1)])))),128))]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[rt,(0,l._)("td",nt,(0,a.zw)(f.order.total),1)])])]),(0,l._)("table",ct,[(0,l._)("tbody",null,[(0,l._)("tr",null,[ut,(0,l._)("td",null,(0,a.zw)(f.order.user.email),1)]),(0,l._)("tr",null,[pt,(0,l._)("td",null,(0,a.zw)(f.order.user.name),1)]),(0,l._)("tr",null,[mt,(0,l._)("td",null,(0,a.zw)(f.order.user.tel),1)]),(0,l._)("tr",null,[ht,(0,l._)("td",null,(0,a.zw)(f.order.user.address),1)]),(0,l._)("tr",null,[_t,(0,l._)("td",null,[f.order.is_paid?((0,l.wg)(),(0,l.iD)("span",bt,"付款完成")):((0,l.wg)(),(0,l.iD)("span",gt,"尚未付款"))])])])]),(0,l._)("div",ft,[(0,l._)("button",{class:"btn btn-primary btn-lg fw-bold text-white",type:"button",onClick:e[9]||(e[9]=t=>f.step=1)},"重新購物"),(0,l._)("button",{class:"btn btn-primary btn-lg fw-bold text-white ms-auto",type:"button",onClick:e[10]||(e[10]=(...t)=>$.payOrder&&$.payOrder(...t))},"確認付款去")])])):((0,l.wg)(),(0,l.iD)("div",vt,[(0,l._)("div",wt,[yt,(0,l._)("button",{class:"btn btn-primary btn-lg align-self-center fw-bold text-white",type:"button",onClick:e[11]||(e[11]=t=>f.step=1)},"重新購物")])]))])])],64)}var kt={data(){return{products:[],cart:{},status:{loadingItem:""},coupon:"",step:1,form:{user:{name:"test",email:"test@gmail.com",tel:"0912346768",address:"kaohsiung"},message:"這是留言"},orderId:"",order:"",isLoading:!1}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/vuefindcard/admin/products?page=1";this.$http.get(t).then((t=>{t.data.success&&(this.products=t.data.products,this.products.splice(4,5))}))},getCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/vuefindcard/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cart=t.data.data),this.isLoading=!1}))},addCart(t){this.status.loadingItem=t;const e="https://vue3-course-api.hexschool.io/api/vuefindcard/cart";this.$http.post(e,{data:{product_id:t,qty:1}}).then((t=>{this.getCart(),this.$httpMessageState(t,"加入購物車"),this.status.loadingItem=""}))},delCartProduct(t){const e=`https://vue3-course-api.hexschool.io/api/vuefindcard/cart/${t}`;this.$http.delete(e).then((t=>{this.getCart(),this.$httpMessageState(t,"刪除商品")}))},delAllCartProducts(){const t="https://vue3-course-api.hexschool.io/api/vuefindcard/carts";this.$http.delete(t).then((t=>{this.getCart(),this.$httpMessageState(t,"刪除商品")}))},updateCartProduct(t){this.isLoading=!0,this.status.loadingItem=t.id;const e=`https://vue3-course-api.hexschool.io/api/vuefindcard/cart/${t.id}`;this.$http.put(e,{data:{product_id:t.id,qty:t.qty}}).then((t=>{this.getCart(),this.$httpMessageState(t,"編輯訂單"),this.status.loadingItem=""}))},useCoupon(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/vuefindcard/coupon";this.$http.post(t,{data:{code:this.coupon}}).then((t=>{this.getCart(),this.$httpMessageState(t,"使用優惠券"),this.coupon="",this.isLoading=!1}))},createOrder(){const t="https://vue3-course-api.hexschool.io/api/vuefindcard/order",e=this.form;this.$http.post(t,{data:e}).then((t=>{this.cart={},this.orderId=t.data.orderId,this.getOrder(this.orderId),this.step=2}))},getOrder(t){const e=`https://vue3-course-api.hexschool.io/api/vuefindcard/order/${t}`;this.$http.get(e).then((t=>{this.order=t.data.order}))},payOrder(){const t=this.orderId,e=`https://vue3-course-api.hexschool.io/api/vuefindcard/pay/${t}`;this.$http.post(e).then((()=>{this.step=3,this.getOrder(t)}))}},created(){this.getProducts(),this.getCart()}},Ct=s(89);const Dt=(0,Ct.Z)(kt,[["render",xt],["__scopeId","data-v-5e696ca6"]]);var $t=Dt}}]);
//# sourceMappingURL=13.d873bdfe.js.map